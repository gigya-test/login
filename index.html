<html>
<head>
    <title>Gigya Login</title>
</head>
<body>
    <h3 id='domain'></h3>
    <h3 id='dataCenter'></h3>
    <p>https://gigya-test.github.io/login/?dataCenter=<i>_dataCenter_</i>&apiKey=<i>_siteApiKey_</i></p>
    <button onclick="openUpdateProfileScreenset()">Update Profile</button>
<script>
// default site to create users for
var dataCenter = 'il1';
var apiKey = '3_DR5_z8VDFZl3KgnaQrCLA8Hxn_vVyZG_aXjEB4Lb-Rcpx_e4DGYCbsl-vmQETc5z';// __base_site
function onJSLoad() {
    gigya.accounts.getAccountInfo({callback: (res) => {
        console.log(res);
        var screenSet = res.UID ? 'Default-RegistrationLogin' : 'Default-ProfileUpdate' 
        gigya.accounts.showScreenSet({ screenSet })
    }});
    
    var domains = window.gigya.partnerSettings.baseDomains;
    var domainEl = document.getElementById("domain");
    domainEl.innerHTML = 'site: ' + domains + ' (' + apiKey +')';
    
    var dcEl = document.getElementById("dataCenter");
    dcEl.innerHTML = 'dataCenter: ' + dataCenter;
}
function loadGigyaScript(url, callback) {
    // Adding the script tag to the head as suggested before
    var head = document.getElementsByTagName('head')[0];
    var script = document.createElement('script');
    script.type = 'text/javascript';
    script.src = url;

    // Then bind the event to the callback function.
    // There are several events for cross browser compatibility.
    script.onreadystatechange = callback;
    script.onload = callback;

    // Fire the loading
    head.appendChild(script);
}
    
function openUpdateProfileScreenset() {
    gigya.accounts.showScreenSet({
        screenSet: 'Default-ProfileUpdate'
        })
}
    
var url = new URL(window.location.href);
dataCenter = url.searchParams.get("dataCenter") || dataCenter;
apiKey = url.searchParams.get("apiKey") || apiKey;
var apiUrl = `https://cdns.` + dataCenter + `.gigya.com/JS/gigya.js?apikey=` + apiKey
loadGigyaScript(apiUrl, onJSLoad)
// us1 / ida-test-soa  
// var apikey=3_tuy1llbPnwe1LmPPl3-UjbVZGwfhKht1mhH-jN0UrKZQLNJsVceDufxv4EUXkoXA    
</script>
</body>
</html>


